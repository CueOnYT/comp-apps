<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>comp-apps — Bug Buster</title>
  <meta name="description" content="A tiny, fast arcade game for Computer Apps class. Works on GitHub Pages in a single file." />
  <style>
    :root{
      --bg:#0b1020;          /* deep navy */
      --panel:#0f1730;       /* darker panel */
      --ink:#e8f0ff;         /* light text */
      --muted:#99a6c6;       /* muted text */
      --brand:#7cf1c8;       /* mint */
      --accent:#9bb4ff;      /* periwinkle */
      --danger:#ff7b9c;      /* coral pink */
      --warn:#ffd36e;        /* warm yellow */
      --ok:#79f28c;          /* green */
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:radial-gradient(1200px 600px at 70% -20%, #1a2450 0%, var(--bg) 60%) fixed;color:var(--ink);font:16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif}
    a{color:var(--brand)}

    .wrap{max-width:1100px;margin-inline:auto;padding:16px;display:grid;gap:16px}

    header{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(0,0,0,.12));
      border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:10px 14px;
      box-shadow:0 20px 50px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06);
      backdrop-filter:saturate(130%) blur(6px);
    }
    .title{display:flex;align-items:center;gap:12px}
    .logo{width:36px;height:36px;border-radius:10px;display:grid;place-items:center;
      background:conic-gradient(from 160deg, var(--brand), var(--accent), var(--brand));
      color:#0a1226;font-weight:900;text-shadow:0 1px 0 rgba(255,255,255,.5)}
    h1{font-size:20px;margin:0}
    .sub{font-size:12px;color:var(--muted)}
    .btn{appearance:none;border:none;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer;
      background:linear-gradient(180deg, #1f2a55, #162044);color:var(--ink);
      border:1px solid rgba(255,255,255,.12);box-shadow:0 6px 20px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06)}
    .btn:hover{filter:brightness(1.06)}
    .btn:active{transform:translateY(1px)}

    .grid{display:grid;grid-template-columns:1fr 320px;gap:16px}
    @media (max-width: 900px){.grid{grid-template-columns:1fr}}

    .card{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(0,0,0,.15));
      border:1px solid rgba(255,255,255,.08);border-radius:18px;padding:14px;
      box-shadow:0 20px 60px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06)}

    /* Canvas and HUD */
    .stage{position:relative;aspect-ratio:16/9;max-height:70vh}
    canvas{width:100%;height:100%;display:block;border-radius:14px;background:radial-gradient(900px 600px at 20% -10%, #131b3a 0%, #0b112a 50%, #070d21 100%)}
    .hud{position:absolute;inset:10px 10px auto 10px;display:flex;gap:8px;flex-wrap:wrap}
    .chip{padding:6px 10px;border-radius:999px;font-weight:700;background:rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.12);backdrop-filter:blur(5px);}
    .chip.good{color:var(--ok)}
    .chip.warn{color:var(--warn)}
    .chip.danger{color:var(--danger)}

    /* Overlays */
    .overlay{position:absolute;inset:0;display:grid;place-items:center;padding:18px;border-radius:14px}
    .panel{max-width:680px;background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.25));
      border:1px solid rgba(255,255,255,.1);border-radius:18px;padding:22px;text-align:center;
      box-shadow:0 20px 60px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.08)}
    .panel h2{margin:0 0 10px;font-size:28px}
    .panel p{margin:0 0 12px;color:var(--muted)}

    /* Controls legend */
    .legend{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    .kbd{display:inline-grid;place-items:center;min-width:28px;height:28px;padding:0 8px;border-radius:8px;
      background:linear-gradient(180deg, #18244a, #121a37);border:1px solid rgba(255,255,255,.14)}

    /* Mobile / touch controls */
    .touch{
      position:absolute;inset:auto 10px 10px auto;display:grid;gap:8px;grid-template-columns:repeat(3,48px);
      opacity:.85;user-select:none;-webkit-user-select:none
    }
    .touch button{width:48px;height:48px;border-radius:50%;border:1px solid rgba(255,255,255,.14);
      background:linear-gradient(180deg, #24305e, #151e3f);color:var(--ink);font-weight:900}
    .touch .wide{grid-column:1 / -1;border-radius:12px}

    /* Sidebar */
    .side h3{margin:8px 0 6px}
    .stat{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-radius:12px;
      background:rgba(0,0,0,.25);border:1px solid rgba(255,255,255,.08);margin:6px 0}
    .muted{color:var(--muted)}
    footer{opacity:.8;text-align:center;font-size:12px;padding:8px}
  </style>
</head>
<body>
  <!--
    comp-apps — Bug Buster
    Single-file HTML5 game built for GitHub Pages.

    How to deploy on GitHub Pages (quick):
    1) Create a repo named comp-apps (or any name).
    2) Add this file as index.html and commit to the default branch (usually main).
    3) In Settings → Pages: Source = Deploy from a branch, Branch = main, Folder = /(root).
    4) Wait for the green check, then open the URL shown in Pages settings.

    Customize: Search for CONFIG below.
    License: MIT — do whatever; attribution appreciated.
  -->

  <div class="wrap">
    <header class="card">
      <div class="title">
        <div class="logo">CA</div>
        <div>
          <h1>comp-apps — <span class="muted">Bug Buster</span></h1>
          <div class="sub">Collect files, dodge bugs, and beat the high score!</div>
        </div>
      </div>
      <div>
        <button class="btn" id="startBtn" aria-label="Start game">▶ Start</button>
        <button class="btn" id="pauseBtn" aria-label="Pause/Resume">⏸︎ Pause</button>
        <button class="btn" id="resetBtn" aria-label="Reset high score">↺ Reset Score</button>
      </div>
    </header>

    <div class="grid">
      <section class="card stage" aria-label="Game stage">
        <canvas id="game" width="960" height="540" role="img" aria-label="Arcade game canvas"></canvas>

        <div class="hud" aria-live="polite">
          <div class="chip" id="scoreChip">Score: 0</div>
          <div class="chip" id="levelChip">Level: 1</div>
          <div class="chip warn" id="timeChip">Time: 60</div>
          <div class="chip" id="filesChip">Files: 0</div>
          <div class="chip" id="bestChip">Best: 0</div>
        </div>

        <div class="overlay" id="startOverlay">
          <div class="panel">
            <h2>Welcome to <strong>Bug Buster</strong>!</h2>
            <p>Move with <span class="kbd">W</span><span class="kbd">A</span><span class="kbd">S</span><span class="kbd">D</span> or arrow keys. Collect the <strong>files</strong>, dodge the <strong>bugs</strong>. Survive to level up!</p>
            <div class="legend">
              <div><strong>Goal</strong><br><span class="muted">Grab squares (+10) • Avoid triangles (-1 life)</span></div>
              <div><strong>Power-ups</strong><br><span class="muted">Stars = slow time • Hearts = +1 life</span></div>
              <div><strong>Keys</strong><br><span class="muted">P = Pause • R = Restart</span></div>
              <div><strong>Mobile</strong><br><span class="muted">Use on-screen joystick</span></div>
            </div>
            <p style="margin-top:12px"><button class="btn" id="overlayStart">Play</button></p>
          </div>
        </div>

        <div class="overlay" id="pauseOverlay" hidden>
          <div class="panel">
            <h2>Paused</h2>
            <p class="muted">Press <span class="kbd">P</span> or tap resume to continue.</p>
            <p><button class="btn" id="overlayResume">Resume</button></p>
          </div>
        </div>

        <div class="overlay" id="gameOverOverlay" hidden>
          <div class="panel">
            <h2>Game Over</h2>
            <p id="finalStats" class="muted">You scored 0 points.</p>
            <p><button class="btn" id="overlayRestart">Try Again</button></p>
          </div>
        </div>

        <!-- Touch controls -->
        <div class="touch" id="touchControls" aria-hidden="true">
          <button data-dx="0" data-dy="-1" aria-label="Up">↑</button>
          <button data-dx="-1" data-dy="0" aria-label="Left">←</button>
          <button data-dx="1" data-dy="0" aria-label="Right">→</button>
          <button data-dx="0" data-dy="1" aria-label="Down">↓</button>
          <button class="wide" id="touchPause">Pause</button>
        </div>
      </section>

      <aside class="card side">
        <h3>About this game</h3>
        <p class="muted">Created for a Computer Apps project. No assets or installs — just one HTML file, perfect for GitHub Pages.</p>
        <div class="stat"><span>High Score</span><strong id="bestSide">0</strong></div>
        <div class="stat"><span>Longest Run</span><strong id="longestSide">0s</strong></div>
        <div class="stat"><span>Files Collected</span><strong id="filesSide">0</strong></div>
        <h3>Tips</h3>
        <ul class="muted">
          <li>Keep moving — speed ramps up every level.</li>
          <li>Grab stars to slow the bugs for 5 seconds.</li>
          <li>Hearts give you an extra life (max 5).</li>
        </ul>
      </aside>
    </div>

    <footer class="muted">comp-apps — Bug Buster · Built with ❤️ using vanilla HTML5 Canvas · MIT License</footer>
  </div>

  <script>
    // ======================
    // CONFIG (tweak freely)
    // ======================
    const CONFIG = {
      startLives: 3,
      maxLives: 5,
      baseSpeed: 2.2,
      playerSpeed: 3.4,
      fileWorth: 10,
      levelTime: 60,  // seconds
      spawnBugEvery: 1200, // ms, decreases with level
      spawnFileEvery: 950, // ms
      spawnPowerEvery: 6000, // ms
      slowMoFactor: 0.45,
      slowMoDuration: 5000,
      levelSpeedBoost: 0.35,
      bugSpeedVariance: 1.1,
    };

    // ======= util ========
    const rnd = (min, max) => Math.random() * (max - min) + min;
    const clamp = (v, a, b) => Math.max(a, Math.min(b, v));
    const dist = (a,b) => Math.hypot(a.x-b.x, a.y-b.y);

    // ======= audio (tiny, no files) ========
    const AudioFX = (()=>{
      let ctx; const ensure = ()=>{ctx ||= new (window.AudioContext||window.webkitAudioContext)()};
      function beep(type='sine', f=440, t=0.08, v=0.06){ ensure(); const o=ctx.createOscillator(); const g=ctx.createGain();
        o.type=type; o.frequency.value=f; g.gain.value=v; o.connect(g).connect(ctx.destination);
        o.start(); o.stop(ctx.currentTime+t); }
      return {
        collect: ()=>beep('triangle', 760, .07, .05),
        hit: ()=>beep('sawtooth', 140, .12, .08),
        level: ()=>beep('square', 520, .18, .06),
        power: ()=>beep('sine', 980, .12, .05)
      }
    })();

    // ======= state ========
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const dpr = Math.max(1, Math.min(2, window.devicePixelRatio||1));
    function resize(){
      const r = canvas.getBoundingClientRect();
      canvas.width = Math.round(r.width * dpr);
      canvas.height = Math.round(r.height * dpr);
    }
    new ResizeObserver(resize).observe(canvas);
    resize();

    const state = {
      running:false, paused:false, over:false,
      level:1, score:0, files:0, lives:CONFIG.startLives,
      tStart:0, tNow:0, tSlowEnd:0, 
      nextBug:0, nextFile:0, nextPower:0,
      player:{x:200,y:200, r:10*dpr, vx:0, vy:0},
      bugs:[], filesArr:[], powers:[],
      best: Number(localStorage.getItem('bb_best')||0),
      longest: Number(localStorage.getItem('bb_longest')||0),
    };

    // ======= draw helpers ========
    function circle(x,y,r,color){ctx.beginPath();ctx.arc(x,y,r,0,Math.PI*2);ctx.fillStyle=color;ctx.fill()}
    function square(x,y,s,color){ctx.fillStyle=color;ctx.fillRect(x-s/2,y-s/2,s,s)}
    function tri(x,y,s,color){ctx.beginPath();ctx.moveTo(x, y-s/1.2);ctx.lineTo(x-s/1.4, y+s/1.8);ctx.lineTo(x+s/1.4, y+s/1.8);ctx.closePath();ctx.fillStyle=color;ctx.fill()}
    function label(text,x,y,size=14){ctx.font=`${size*dpr}px/1.2 ui-sans-serif, system-ui`;ctx.fillStyle='rgba(232,240,255,.9)';ctx.textAlign='center';ctx.fillText(text,x,y)}

    // ======= entities ========
    function spawnBug(){
      const speed = (CONFIG.baseSpeed + (state.level-1)*CONFIG.levelSpeedBoost) * dpr * rnd(0.8, CONFIG.bugSpeedVariance);
      const edge = Math.random()<.5 ? 'x' : 'y';
      let x, y; if(edge==='x'){ x=Math.random()<.5? -20: canvas.width+20; y=rnd(0, canvas.height) } else { y=Math.random()<.5? -20: canvas.height+20; x=rnd(0, canvas.width)}
      const ang = Math.atan2(state.player.y - y, state.player.x - x);
      state.bugs.push({x,y, s:18*dpr, vx:Math.cos(ang)*speed, vy:Math.sin(ang)*speed});
    }
    function spawnFile(){ state.filesArr.push({x:rnd(30,canvas.width-30), y:rnd(30,canvas.height-30), s:16*dpr}); }
    function spawnPower(){
      const kind = Math.random()<.65 ? 'slow' : 'life';
      state.powers.push({kind, x:rnd(30,canvas.width-30), y:rnd(30,canvas.height-30), s:16*dpr, t:performance.now()+7000});
    }

    // ======= input ========
    const keys = new Set();
    addEventListener('keydown', e=>{
      if(['ArrowUp','ArrowDown','ArrowLeft','ArrowRight','w','a','s','d','W','A','S','D'].includes(e.key)) {keys.add(e.key.toLowerCase()); e.preventDefault();}
      if(e.key==='p' || e.key==='P') togglePause();
      if(e.key==='r' || e.key==='R') startGame();
    });
    addEventListener('keyup', e=> keys.delete(e.key.toLowerCase()));

    // Touch controls
    const touch = document.getElementById('touchControls');
    const isTouch = matchMedia('(pointer: coarse)').matches; 
    if(isTouch) touch.removeAttribute('aria-hidden');
    let touchVec = {x:0,y:0};
    touch.addEventListener('touchstart', onTouch, {passive:false});
    touch.addEventListener('touchend', onTouch, {passive:false});
    touch.addEventListener('touchcancel', onTouch, {passive:false});
    touch.addEventListener('touchmove', onTouch, {passive:false});
    function onTouch(e){
      const t = e.target.closest('button');
      if(!t) return; e.preventDefault();
      if(t.id==='touchPause'){ togglePause(); return; }
      const dx = Number(t.dataset.dx), dy = Number(t.dataset.dy);
      if(e.type==='touchstart') touchVec={x:dx, y:dy};
      if(e.type==='touchend' || e.type==='touchcancel') touchVec={x:0,y:0};
    }

    // ======= game loop ========
    function startGame(){
      state.running=true; state.paused=false; state.over=false;
      state.level=1; state.score=0; state.files=0; state.lives=CONFIG.startLives;
      state.bugs.length=0; state.filesArr.length=0; state.powers.length=0;
      state.tStart=performance.now(); state.tNow=state.tStart; state.tSlowEnd=0;
      state.nextBug=0; state.nextFile=0; state.nextPower=0;
      const r = canvas.getBoundingClientRect();
      state.player.x = (r.width*0.5)*dpr; state.player.y = (r.height*0.6)*dpr;
      hide(startOverlay); hide(gameOverOverlay); hide(pauseOverlay);
      loop();
    }

    function togglePause(){ if(!state.running || state.over) return; state.paused = !state.paused; show(pauseOverlay, state.paused); if(!state.paused) loop(); }
    function gameOver(){
      state.over = true; state.running=false; show(gameOverOverlay,true);
      const time = Math.round((state.tNow - state.tStart)/1000);
      state.longest = Math.max(state.longest, time);
      localStorage.setItem('bb_longest', state.longest);
      state.best = Math.max(state.best, state.score);
      localStorage.setItem('bb_best', state.best);
      document.getElementById('finalStats').textContent = `You scored ${state.score} points, reached level ${state.level}, and collected ${state.files} files in ${time}s.`;
      updateHUD();
    }

    function loop(t){
      if(!state.running || state.paused) return;
      requestAnimationFrame(loop);
      const now = performance.now();
      const dt = Math.min(32, (now - state.tNow)) * (now < state.tSlowEnd ? CONFIG.slowMoFactor : 1);
      state.tNow = now;

      // Level timer
      const elapsed = Math.floor((now - state.tStart)/1000);
      const remain = Math.max(0, CONFIG.levelTime - (elapsed % CONFIG.levelTime));
      if(remain===0 && Math.floor((now - state.tStart - (dt))/1000) % CONFIG.levelTime !== 0){ // just ticked
        state.level++; AudioFX.level();
      }

      // Spawns
      if(now > state.nextBug){ spawnBug(); state.nextBug = now + Math.max(350, CONFIG.spawnBugEvery - state.level*60); }
      if(now > state.nextFile){ spawnFile(); state.nextFile = now + CONFIG.spawnFileEvery; }
      if(now > state.nextPower){ spawnPower(); state.nextPower = now + CONFIG.spawnPowerEvery; }

      // Input -> velocity
      const ps = CONFIG.playerSpeed * dpr;
      const ax = (keys.has('arrowleft')||keys.has('a') ? -1 : 0) + (keys.has('arrowright')||keys.has('d') ? 1 : 0) + touchVec.x;
      const ay = (keys.has('arrowup')||keys.has('w') ? -1 : 0) + (keys.has('arrowdown')||keys.has('s') ? 1 : 0) + touchVec.y;
      state.player.vx = ax * ps; state.player.vy = ay * ps;

      // Move player
      state.player.x = clamp(state.player.x + state.player.vx, 10*dpr, canvas.width-10*dpr);
      state.player.y = clamp(state.player.y + state.player.vy, 10*dpr, canvas.height-10*dpr);

      // Move bugs
      const speedMult = now < state.tSlowEnd ? 0.4 : 1;
      for(const b of state.bugs){ b.x += b.vx * (dt/16) * speedMult; b.y += b.vy * (dt/16) * speedMult; }
      // Remove offscreen bugs (with margin)
      state.bugs = state.bugs.filter(b => b.x>-60 && b.x<canvas.width+60 && b.y>-60 && b.y<canvas.height+60);

      // Collisions: player-files
      state.filesArr = state.filesArr.filter(f=>{
        const hit = dist(state.player, f) < (state.player.r + f.s*0.7);
        if(hit){ state.score += CONFIG.fileWorth; state.files++; AudioFX.collect(); }
        return !hit;
      });

      // Collisions: player-powers
      state.powers = state.powers.filter(p=>{
        const expired = now > p.t; if(expired) return false;
        const hit = dist(state.player, p) < (state.player.r + p.s*0.7);
        if(hit){ if(p.kind==='slow'){ state.tSlowEnd = now + CONFIG.slowMoDuration; AudioFX.power(); }
                 else if(p.kind==='life' && state.lives < CONFIG.maxLives){ state.lives++; AudioFX.power(); }
        }
        return !hit;
      });

      // Collisions: player-bugs
      for(let i=state.bugs.length-1;i>=0;i--){
        const b = state.bugs[i];
        if(dist(state.player, b) < (state.player.r + b.s*0.5)){
          state.bugs.splice(i,1); state.lives--; AudioFX.hit();
          if(state.lives<=0){ gameOver(); break; }
        }
      }

      // Draw
      ctx.clearRect(0,0,canvas.width,canvas.height);
      // subtle grid
      ctx.globalAlpha = 0.07; ctx.strokeStyle = '#7cf1c833'; ctx.lineWidth = 1*dpr; const step=40*dpr;
      for(let x=step; x<canvas.width; x+=step){ ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,canvas.height); ctx.stroke(); }
      for(let y=step; y<canvas.height; y+=step){ ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(canvas.width,y); ctx.stroke(); }
      ctx.globalAlpha = 1;

      // files (squares)
      for(const f of state.filesArr){ square(f.x, f.y, f.s, '#9bb4ff'); }
      // powers
      for(const p of state.powers){ if(p.kind==='slow'){ circle(p.x,p.y,10*dpr,'#7cf1c8'); label('★',p.x,p.y+4*dpr,14);} else { circle(p.x,p.y,10*dpr,'#79f28c'); label('❤',p.x,p.y+5*dpr,14);} }
      // bugs (triangles)
      for(const b of state.bugs){ tri(b.x,b.y,b.s,'#ff7b9c'); }
      // player
      circle(state.player.x, state.player.y, state.player.r, '#e8f0ff');

      // HUD labels floating
      label('You', state.player.x, state.player.y - 16*dpr, 12);

      updateHUD(remain);
    }

    function updateHUD(remain){
      document.getElementById('scoreChip').textContent = `Score: ${state.score}`;
      document.getElementById('levelChip').textContent = `Level: ${state.level}`;
      document.getElementById('filesChip').textContent = `Files: ${state.files}`;
      document.getElementById('timeChip').textContent = `Time: ${typeof remain==='number'?remain: Math.max(0, CONFIG.levelTime - Math.floor((state.tNow - state.tStart)/1000)%CONFIG.levelTime)}`;
      document.getElementById('bestChip').textContent = `Best: ${state.best}`;
      document.getElementById('bestSide').textContent = state.best;
      const time = Math.round((state.tNow - state.tStart)/1000);
      document.getElementById('longestSide').textContent = `${Math.max(state.longest, time)}s`;
      document.getElementById('filesSide').textContent = state.files;

      const timeChip = document.getElementById('timeChip');
      const r = (typeof remain==='number')? remain : Math.max(0, CONFIG.levelTime - (Math.floor((state.tNow - state.tStart)/1000)%CONFIG.levelTime));
      timeChip.classList.toggle('danger', r<=10);
      timeChip.classList.toggle('warn', r>10);
    }

    // ======= helpers ========
    const startOverlay = document.getElementById('startOverlay');
    const pauseOverlay = document.getElementById('pauseOverlay');
    const gameOverOverlay = document.getElementById('gameOverOverlay');
    const overlayStart = document.getElementById('overlayStart');
    const overlayResume = document.getElementById('overlayResume');
    const overlayRestart = document.getElementById('overlayRestart');
    const startBtn = document.getElementById('startBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const resetBtn = document.getElementById('resetBtn');

    function show(el, on=true){ el.hidden = !on; }
    function hide(el){ el.hidden = true; }

    overlayStart.addEventListener('click', startGame);
    overlayResume.addEventListener('click', togglePause);
    overlayRestart.addEventListener('click', startGame);
    startBtn.addEventListener('click', startGame);
    pauseBtn.addEventListener('click', togglePause);
    resetBtn.addEventListener('click', ()=>{ localStorage.removeItem('bb_best'); localStorage.removeItem('bb_longest'); state.best=0; state.longest=0; updateHUD(); });

    // Start with overlay visible
    show(startOverlay,true);
  </script>
</body>
</html>
