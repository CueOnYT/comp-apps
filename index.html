<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Devin's Games ‚Äî Game Hub</title>
  <meta name="description" content="Devin's Games ‚Äî Slots, Blackjack, Math Sprint, Typing, 3D Retro Drift. Shared wallet, shop, customization." />
  <link rel="stylesheet" href="styles.css">
  <!-- Three.js -->
  <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>

  <!-- Immediate fixes to prevent canvas blocking the whole page:
       - UI elements get higher z-index
       - Game canvas only accepts pointer events when its panel is active
       - marks overlay never receives pointer events
  -->
  <style>
    /* Ensure interactive UI is above the game canvas */
    header.top, nav.tabs, .tab, .controls, .btn, .shop-item, footer.footer {
      position: relative;
      z-index: 1000;
      pointer-events: auto;
    }

    /* Game area isolation:
       - canvas won't capture clicks unless the game panel has .active
       - the 2D marks overlay never captures pointer events (it is purely visual)
    */
    #sec-game:not(.active) #driftCanvas,
    #sec-game:not(.active) #marksCanvas {
      pointer-events: none !important;
    }

    /* When active, the canvas can receive events */
    #sec-game.active #driftCanvas { pointer-events: auto !important; }
    #marksCanvas { pointer-events: none; }

    /* Small safety for mobile: disable tap highlight while holding bet buttons */
    .no-select{ user-select:none; -webkit-user-select:none; -ms-user-select:none; -moz-user-select:none; }
  </style>
</head>
<body>
  <div id="app" class="app">
    <header class="top">
      <div class="brand">
        <div class="logo">DG</div>
        <div>
          <h1>Devin‚Äôs Games</h1>
          <p class="tag">Fun practice games ‚Äî made by Devin Slifer</p>
        </div>
      </div>

      <nav class="tabs" role="tablist" aria-label="Game Tabs">
        <button class="tab" data-tab="slots" aria-current="page" title="1">üé∞ Slots</button>
        <button class="tab" data-tab="blackjack" title="2">üÇ° Blackjack</button>
        <button class="tab" data-tab="math" title="3">‚ûó Math Sprint</button>
        <button class="tab" data-tab="typing" title="4">‚å®Ô∏è Typing</button>
        <button class="tab" data-tab="game" title="5">üöó Game</button>
        <button class="tab" data-tab="shop" title="6">üõí Shop</button>
        <button class="tab" data-tab="custom" title="7">‚öôÔ∏è Customize</button>
      </nav>
    </header>

    <main class="main">
      <!-- WALLET HUD -->
      <section class="panel active" id="sec-home" role="region" aria-label="Wallet">
        <div class="hud sticky">
          <div class="pill">Coins: <strong id="walletVal" class="walletVal">100</strong></div>
          <div class="pill small">Shortcuts: <span class="muted">1-7 switch tabs ‚Ä¢ S spin ‚Ä¢ D deal ‚Ä¢ H hit ‚Ä¢ J stand ‚Ä¢ M math start ‚Ä¢ Enter answer ‚Ä¢ T typing start ‚Ä¢ G go Game ‚Ä¢ P open Shop</span></div>
        </div>
      </section>

      <!-- SLOTS -->
      <section id="sec-slots" class="panel active" role="tabpanel" aria-labelledby="tab-slots">
        <h2>Lucky Slots</h2>
        <p class="slots-note">My janitor at my school ‚Äî his name is James ‚Äî he‚Äôs really chill and he used the slot machine for me and got me a triple üçã ‚Äî thank you James!</p>

        <div class="hud">
          <div class="pill">Coins: <strong id="slotsBal" class="walletVal">100</strong></div>
          <div class="pill">Bet: <strong id="slotsBet">5</strong></div>
          <div class="pill">Best: <strong id="slotsBest">0</strong></div>
        </div>

        <div class="layout two-col">
          <div>
            <div class="reels">
              <div class="reel" id="reel1">üçí</div>
              <div class="reel" id="reel2">üçã</div>
              <div class="reel" id="reel3">‚≠ê</div>
            </div>

            <div class="controls">
              <button class="btn primary" id="spinBtn" title="S">Spin</button>
              <div class="bet-controls">
                <button class="btn hold" id="betDown" data-dir="-" title="-">‚àí</button>
                <div class="bet-display" id="betDisplay">5</div>
                <button class="btn hold" id="betUp" data-dir="+" title="+">+</button>
              </div>
            </div>

            <div id="slotsMsg" class="message muted">Ready to play.</div>
          </div>

          <aside>
            <div class="card small">
              <h3>Payouts</h3>
              <ul>
                <li>3√ó ‚≠ê = 20√ó bet</li>
                <li>3√ó üçí = 12√ó bet</li>
                <li>3√ó üçã = 8√ó bet</li>
                <li>Any 2 matching = 4√ó bet</li>
              </ul>
              <p class="muted">No negatives ‚Äî you can‚Äôt bet coins you don‚Äôt have.</p>
            </div>

            <div class="card small">
              <h4>Thanks</h4>
              <p class="muted">Big thanks to James ‚Äî triple üçã legend.</p>
            </div>
          </aside>
        </div>
      </section>

      <!-- BLACKJACK -->
      <section id="sec-blackjack" class="panel" role="tabpanel" aria-hidden="true">
        <h2>Blackjack</h2>
        <div class="hud">
          <div class="pill">Coins: <strong id="bjBank" class="walletVal">100</strong></div>
          <div class="pill">Bet: <strong id="bjBet">10</strong></div>
        </div>

        <div class="layout two-col">
          <div>
            <h4>Dealer (<span id="dVal">?</span>)</h4>
            <div class="cards" id="dealer"></div>

            <h4>You (<span id="pVal">0</span>)</h4>
            <div class="cards" id="player"></div>

            <div class="controls">
              <button class="btn primary hold" id="bjDeal" title="D">Deal</button>
              <button class="btn" id="bjHit" disabled title="H">Hit</button>
              <button class="btn" id="bjStand" disabled title="J">Stand</button>

              <div class="bet-controls small">
                <button class="btn ghost hold" id="bjBetDown" data-dir="-" title="-">‚àí</button>
                <div class="bet-display" id="bjBetDisplay">10</div>
                <button class="btn ghost hold" id="bjBetUp" data-dir="+" title="+">+</button>
              </div>
            </div>

            <div id="bjMsg" class="message muted">Good luck!</div>
          </div>

          <aside>
            <div class="card small">
              <h3>Rules</h3>
              <ul>
                <li>Ace is 1 or 11</li>
                <li>Dealer hits to 16 and stands on 17+</li>
                <li>Blackjack pays 3:2</li>
              </ul>
            </div>
          </aside>
        </div>
      </section>

      <!-- MATH -->
      <section id="sec-math" class="panel" role="tabpanel" aria-hidden="true">
        <h2>Math Sprint</h2>
        <div class="hud">
          <div class="pill">Score: <strong id="mathScore">0</strong></div>
          <div class="pill">Streak: <strong id="mathStreak">0</strong></div>
          <div class="pill">Time: <strong id="mathTime">60</strong>s</div>
        </div>

        <div class="layout two-col">
          <div>
            <div class="problem" id="mathQ">Loading...</div>
            <div class="controls">
              <input id="mathA" type="number" placeholder="Answer" />
              <button class="btn primary" id="mathSubmit" title="Enter">Submit</button>
              <button class="btn" id="mathStart" title="M">Start</button>
            </div>
            <div id="mathMsg" class="message muted"></div>
          </div>

          <aside>
            <div class="card small">
              <h3>Math Settings</h3>
              <label><input type="checkbox" id="mAdd" checked> Add</label><br/>
              <label><input type="checkbox" id="mSub" checked> Subtract</label><br/>
              <label><input type="checkbox" id="mMul" checked> Multiply</label><br/>
              <label><input type="checkbox" id="mDiv"> Divide</label><br/>
              <label>Difficulty:
                <select id="mDiff">
                  <option value="easy">Easy</option>
                  <option value="medium" selected>Medium</option>
                  <option value="hard">Hard</option>
                </select>
              </label>
              <p class="muted">Hard mode includes chained problems.</p>
            </div>
          </aside>
        </div>
      </section>

      <!-- TYPING -->
      <section id="sec-typing" class="panel" role="tabpanel" aria-hidden="true">
        <h2>Typing Test</h2>
        <div class="hud">
          <div class="pill">WPM: <strong id="typeWpm">0</strong></div>
          <div class="pill">Accuracy: <strong id="typeAcc">100%</strong></div>
          <div class="pill">Time: <strong id="typeTime">30</strong>s</div>
        </div>

        <div class="typing-area">
          <div id="typingText" class="typingText" aria-live="polite"></div>
          <div class="controls">
            <input id="typeInput" type="text" placeholder="Tap Start then type here" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
            <button class="btn primary" id="typeStart" title="T">Start</button>
          </div>
          <div id="typeMsg" class="message muted"></div>
        </div>
      </section>

      <!-- 3D DRIFT GAME -->
      <section id="sec-game" class="panel" role="tabpanel" aria-hidden="true">
        <h2>Retro Drift ‚Äî Low-poly City</h2>
        <div class="hud">
          <div class="pill">Style Points: <strong id="driftScore">0</strong></div>
          <div class="pill">Best: <strong id="driftBest">0</strong></div>
          <div class="pill">Car: <strong id="driftCarName">Classic</strong></div>
        </div>

        <div class="game-wrap">
          <canvas id="driftCanvas"></canvas>
          <!-- 2D marks overlay -->
          <canvas id="marksCanvas" class="marks"></canvas>

          <!-- virtual joysticks -->
          <div class="joysticks" id="joysticks" aria-hidden="true">
            <div class="stick" id="stickLeft" aria-hidden="true"></div>
            <div class="stick" id="stickRight" aria-hidden="true"></div>
          </div>

          <!-- mobile buttons fallback -->
          <div class="mobile-controls" id="mobileCtrls">
            <button class="pad" id="btnLeft">‚óÄ</button>
            <button class="pad" id="btnRight">‚ñ∂</button>
            <button class="pad" id="btnAccel">‚ñ≤</button>
            <button class="pad" id="btnBrake">‚ñ†</button>
          </div>
        </div>

        <div class="message muted">Use WASD or arrows on desktop, dual joysticks or buttons on mobile. Drift to make tire marks & earn style points.</div>
      </section>

      <!-- SHOP -->
      <section id="sec-shop" class="panel" role="tabpanel" aria-hidden="true">
        <h2>Shop</h2>
        <p class="muted">Spend your coins on cosmetics, boosts, themes. Items persist locally.</p>

        <div class="shop-grid" id="shopGrid">
          <!-- populated by JS -->
        </div>
      </section>

      <!-- CUSTOMIZATION -->
      <section id="sec-custom" class="panel" role="tabpanel" aria-hidden="true">
        <h2>Customization</h2>

        <div class="card">
          <label>Theme:
            <select id="themeSelect">
              <option value="dark" selected>Dark</option>
              <option value="light">Light</option>
            </select>
          </label>

          <label>Accent:
            <input type="color" id="accentPicker" value="#7cf1c8" />
          </label>

          <label>Font size:
            <input id="fontSize" type="range" min="13" max="20" value="16">
          </label>

          <label>Typing time:
            <select id="typingDur">
              <option value="15">15s</option>
              <option value="30" selected>30s</option>
              <option value="60">60s</option>
            </select>
          </label>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div>Created by Devin Slifer ‚Äî <a href="https://cuesshop.myshopify.com" target="_blank" rel="noopener">cuesshop.myshopify.com</a></div>
      <div class="muted small">For Computer Apps ‚Äî have fun & good luck!</div>
    </footer>
  </div>

  <!-- Small script so canvas pointer-events follow the active tab immediately -->
  <script>
    function updateGameCanvasPointer(){
      const sec = document.getElementById('sec-game');
      const canvas = document.getElementById('driftCanvas');
      const marks = document.getElementById('marksCanvas');
      if(!canvas || !sec) return;
      if(sec.classList.contains('active')){
        canvas.style.pointerEvents = 'auto';
      } else {
        canvas.style.pointerEvents = 'none';
      }
      if(marks) marks.style.pointerEvents = 'none';
    }
    document.addEventListener('DOMContentLoaded', ()=>{
      updateGameCanvasPointer();
      // Tabs are buttons that set .active on panels in app.js ‚Äî also listen for clicks and update after
      document.querySelectorAll('.tab').forEach(t => t.addEventListener('click', ()=> setTimeout(updateGameCanvasPointer, 60)));
      // also update when panels change (in case app.js toggles classes later)
      const obs = new MutationObserver(()=> updateGameCanvasPointer());
      document.querySelectorAll('.panel').forEach(p=> obs.observe(p, { attributes: true, attributeFilter: ['class'] }));
    });
  </script>

  <script src="app.js"></script>
</body>
</html>
